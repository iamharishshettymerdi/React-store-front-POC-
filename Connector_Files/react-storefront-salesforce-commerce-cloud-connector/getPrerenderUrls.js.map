{"version":3,"sources":["../src/getPrerenderUrls.js"],"names":["getClient","getPrerenderUrls","options","offset","limit","client","categories","getMenu","paths","category","push","path","id","search","findProducts","refine","hits","hit","productId"],"mappings":"AAAA,OAAOA,SAAP,MAAsB,gBAAtB,C,CAEA;;AACA,eAAe,eAAeC,gBAAf,CAAgCC,OAAO,GAAG;AAAEC,EAAAA,MAAM,EAAE,CAAV;AAAaC,EAAAA,KAAK,EAAE;AAApB,CAA1C,EAAoE;AACjF,QAAMC,MAAM,GAAG,MAAML,SAAS,EAA9B;AAEA,QAAM;AAAEM,IAAAA,UAAU,GAAG;AAAf,MAAsB,MAAMD,MAAM,CAACE,OAAP,EAAlC;AAEA,QAAMC,KAAK,GAAG,EAAd,CALiF,CAOjF;;AACA,OAAK,IAAIC,QAAT,IAAqBH,UAArB,EAAiC;AAC/BE,IAAAA,KAAK,CAACE,IAAN,CAAW;AAAEC,MAAAA,IAAI,EAAG,MAAKF,QAAQ,CAACG,EAAG;AAA1B,KAAX;AACAJ,IAAAA,KAAK,CAACE,IAAN,CAAW;AAAEC,MAAAA,IAAI,EAAG,UAASF,QAAQ,CAACG,EAAG;AAA9B,KAAX,EAF+B,CAI/B;;AACA,UAAMC,MAAM,GAAG,MAAMR,MAAM,CAACS,YAAP,CAAoB,EACvC,GAAGZ,OADoC;AAEvCa,MAAAA,MAAM,EAAE,CAAE,QAAON,QAAQ,CAACG,EAAG,EAArB;AAF+B,KAApB,CAArB;;AAKA,QAAIC,MAAM,CAACG,IAAX,EAAiB;AACf,WAAK,IAAIC,GAAT,IAAgBJ,MAAM,CAACG,IAAvB,EAA6B;AAC3BR,QAAAA,KAAK,CAACE,IAAN,CAAW;AAAEC,UAAAA,IAAI,EAAG,MAAKM,GAAG,CAACC,SAAU;AAA5B,SAAX;AACAV,QAAAA,KAAK,CAACE,IAAN,CAAW;AAAEC,UAAAA,IAAI,EAAG,UAASM,GAAG,CAACC,SAAU;AAAhC,SAAX;AACD;AACF;AACF;;AAED,SAAOV,KAAP;AACD","sourcesContent":["import getClient from './utils/client'\n\n// Fetches the page and API paths for all categories and a few product from each specified by the given options\nexport default async function getPrerenderUrls(options = { offset: 0, limit: 10 }) {\n  const client = await getClient()\n\n  const { categories = [] } = await client.getMenu()\n\n  const paths = []\n\n  // Prerender all category pages\n  for (let category of categories) {\n    paths.push({ path: `/s/${category.id}` })\n    paths.push({ path: `/api/s/${category.id}` })\n\n    // Try prerendering the first 10 products of each category\n    const search = await client.findProducts({\n      ...options,\n      refine: [`cgid=${category.id}`],\n    })\n\n    if (search.hits) {\n      for (let hit of search.hits) {\n        paths.push({ path: `/p/${hit.productId}` })\n        paths.push({ path: `/api/p/${hit.productId}` })\n      }\n    }\n  }\n\n  return paths\n}\n"],"file":"getPrerenderUrls.js"}