{"version":3,"sources":["../src/product.js"],"names":["getClient","normalizeProduct","createAppData","fulfillAPIRequest","product","id","req","color","size","query","client","raw","getProduct","allImages","category","getCategory","primaryCategoryId","result","appData","pageData","getPageData","prod","title","name","breadcrumbs","text","href","as"],"mappings":"AAAA,OAAOA,SAAP,MAAsB,gBAAtB;AACA,OAAOC,gBAAP,MAA6B,0BAA7B;AACA,OAAOC,aAAP,MAA0B,uBAA1B;AAEA,OAAOC,iBAAP,MAA8B,0CAA9B,C,CACA;;AAEA,eAAe,eAAeC,OAAf,CAAuB;AAAEC,EAAAA;AAAF,CAAvB,EAA+BC,GAA/B,EAAoC;AACjD,QAAM;AAAEC,IAAAA,KAAF;AAASC,IAAAA;AAAT,MAAkBF,GAAG,CAACG,KAA5B;AACA,QAAMC,MAAM,GAAG,MAAMV,SAAS,CAACM,GAAD,CAA9B;AACA,QAAMK,GAAG,GAAG,MAAMD,MAAM,CAACE,UAAP,CAAkBP,EAAlB,EAAsB;AAAEQ,IAAAA,SAAS,EAAE;AAAb,GAAtB,CAAlB;AACA,QAAMC,QAAQ,GAAG,MAAMJ,MAAM,CAACK,WAAP,CAAmBJ,GAAG,CAACK,iBAAvB,CAAvB;AACA,QAAMC,MAAM,GAAG,MAAMd,iBAAiB,CAACG,GAAD,EAAM;AAC1CY,IAAAA,OAAO,EAAEhB,aADiC;AAE1CiB,IAAAA,QAAQ,EAAE,MAAMC,WAAW,CAACnB,gBAAgB,CAACU,GAAD,EAAMJ,KAAN,EAAaC,IAAb,CAAjB,EAAqCM,QAArC;AAFe,GAAN,CAAtC;AAIA,SAAOG,MAAP;AACD;;AAED,eAAeG,WAAf,CAA2BC,IAA3B,EAAiCP,QAAjC,EAA2C;AACzC,QAAMG,MAAM,GAAG;AACbK,IAAAA,KAAK,EAAED,IAAI,CAACE,IADC;AAEbnB,IAAAA,OAAO,EAAEiB,IAFI;AAGbG,IAAAA,WAAW,EAAE,CACX;AACEC,MAAAA,IAAI,EAAG,MADT;AAEEC,MAAAA,IAAI,EAAE;AAFR,KADW,EAKX;AACED,MAAAA,IAAI,EAAEX,QAAQ,CAACS,IADjB;AAEEI,MAAAA,EAAE,EAAG,MAAKb,QAAQ,CAACT,EAAG,EAFxB;AAGEqB,MAAAA,IAAI,EAAE;AAHR,KALW;AAHA,GAAf,CADyC,CAiBzC;AACA;AACA;;AAEA,SAAOT,MAAP;AACD","sourcesContent":["import getClient from './utils/client'\nimport normalizeProduct from './utils/normalizeProduct'\nimport createAppData from './utils/createAppData'\n\nimport fulfillAPIRequest from 'react-storefront/props/fulfillAPIRequest'\n// import getBase64ForImage from 'react-storefront/utils/getBase64ForImage'\n\nexport default async function product({ id }, req) {\n  const { color, size } = req.query\n  const client = await getClient(req)\n  const raw = await client.getProduct(id, { allImages: true })\n  const category = await client.getCategory(raw.primaryCategoryId)\n  const result = await fulfillAPIRequest(req, {\n    appData: createAppData,\n    pageData: () => getPageData(normalizeProduct(raw, color, size), category),\n  })\n  return result\n}\n\nasync function getPageData(prod, category) {\n  const result = {\n    title: prod.name,\n    product: prod,\n    breadcrumbs: [\n      {\n        text: `Home`,\n        href: '/',\n      },\n      {\n        text: category.name,\n        as: `/s/${category.id}`,\n        href: '/s/[subcategoryId]',\n      },\n    ],\n  }\n\n  // TODO: implement this\n  // const mainProductImage = result.product.media.full[0]\n  // mainProductImage.src = await getBase64ForImage(mainProductImage.src)\n\n  return result\n}\n"],"file":"product.js"}