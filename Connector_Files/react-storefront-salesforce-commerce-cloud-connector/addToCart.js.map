{"version":3,"sources":["../src/addToCart.js"],"names":["isEqual","getClient","getCart","addToCart","product","quantity","color","size","req","res","attr","client","raw","getProduct","id","variant","variants","find","variationValues","Error","productId","cart","e","status"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,gBAApB;AACA,OAAOC,SAAP,MAAsB,gBAAtB;AACA,OAAOC,OAAP,MAAoB,iBAApB;AAEA,eAAe,eAAeC,SAAf,CAAyB;AAAEC,EAAAA,OAAF;AAAWC,EAAAA,QAAX;AAAqBC,EAAAA,KAArB;AAA4BC,EAAAA;AAA5B,CAAzB,EAA6DC,GAA7D,EAAkEC,GAAlE,EAAuE;AACpF;AAEA,QAAMC,IAAI,GAAG,EAAb;AACA,MAAIJ,KAAJ,EAAWI,IAAI,CAACJ,KAAL,GAAaA,KAAb;AACX,MAAIC,IAAJ,EAAUG,IAAI,CAACH,IAAL,GAAYA,IAAZ;AAEV,QAAMI,MAAM,GAAGV,SAAS,CAACO,GAAD,CAAxB;AACA,QAAMI,GAAG,GAAG,MAAMD,MAAM,CAACE,UAAP,CAAkBT,OAAO,CAACU,EAA1B,CAAlB;AAEA,QAAMC,OAAO,GAAGH,GAAG,CAACI,QAAJ,CAAaC,IAAb,CAAkB,CAAC;AAAEC,IAAAA;AAAF,GAAD,KAAyB;AACzD,WAAOlB,OAAO,CAACkB,eAAD,EAAkBR,IAAlB,CAAd;AACD,GAFe,CAAhB;;AAIA,MAAI,CAACK,OAAL,EAAc;AACZ,UAAM,IAAII,KAAJ,CAAU,gCAAV,CAAN;AACD;;AAED,MAAI;AACF,UAAMR,MAAM,CAACR,SAAP,CAAiB;AAAEiB,MAAAA,SAAS,EAAEL,OAAO,CAACK,SAArB;AAAgCf,MAAAA;AAAhC,KAAjB,CAAN;AACA,WAAO;AAAEgB,MAAAA,IAAI,EAAE,MAAMnB,OAAO,CAACS,MAAD;AAArB,KAAP;AACD,GAHD,CAGE,OAAOW,CAAP,EAAU;AACVb,IAAAA,GAAG,CAACc,MAAJ,CAAW,GAAX;AACA,WAAO;AAAED,MAAAA;AAAF,KAAP;AACD;AACF","sourcesContent":["import isEqual from 'lodash/isEqual'\nimport getClient from './utils/client'\nimport getCart from './utils/getCart'\n\nexport default async function addToCart({ product, quantity, color, size }, req, res) {\n  // Fetch and find product with given {color, size} variation values\n\n  const attr = {}\n  if (color) attr.color = color\n  if (size) attr.size = size\n\n  const client = getClient(req)\n  const raw = await client.getProduct(product.id)\n\n  const variant = raw.variants.find(({ variationValues }) => {\n    return isEqual(variationValues, attr)\n  })\n\n  if (!variant) {\n    throw new Error('Could not find product variant')\n  }\n\n  try {\n    await client.addToCart({ productId: variant.productId, quantity })\n    return { cart: await getCart(client) }\n  } catch (e) {\n    res.status(500)\n    return { e }\n  }\n}\n"],"file":"addToCart.js"}