{"version":3,"sources":["../src/subcategory.js"],"names":["fulfillAPIRequest","getClient","createAppData","productListing","subcategory","params","req","appData","pageData","getPageData","filters","categorySlug","query","client","data","getCategory","plp","refine","JSON","parse","id","name","title","pageTitle","breadcrumbs","text","href","parentCategoryId"],"mappings":"AAAA,OAAOA,iBAAP,MAA8B,0CAA9B;AACA,OAAOC,SAAP,MAAsB,gBAAtB;AACA,OAAOC,aAAP,MAA0B,uBAA1B;AACA,OAAOC,cAAP,MAA2B,wBAA3B;AAEA,eAAe,eAAeC,WAAf,CAA2BC,MAA3B,EAAmCC,GAAnC,EAAwC;AACrD,SAAO,MAAMN,iBAAiB,CAACM,GAAD,EAAM;AAClCC,IAAAA,OAAO,EAAEL,aADyB;AAElCM,IAAAA,QAAQ,EAAE,MAAMC,WAAW,CAACJ,MAAD,EAASC,GAAT;AAFO,GAAN,CAA9B;AAID;;AAED,eAAeG,WAAf,CAA2BJ,MAA3B,EAAmCC,GAAnC,EAAwC;AACtC,QAAM;AAAEI,IAAAA,OAAO,GAAG;AAAZ,MAAqBL,MAA3B;AACA,QAAM;AAAEM,IAAAA;AAAF,MAAmBL,GAAG,CAACM,KAA7B;AAEA,QAAMC,MAAM,GAAG,MAAMZ,SAAS,CAACK,GAAD,CAA9B;AACA,QAAMQ,IAAI,GAAG,MAAMD,MAAM,CAACE,WAAP,CAAmBJ,YAAnB,CAAnB;AAEA,QAAMK,GAAG,GAAG,MAAMb,cAAc,CAACE,MAAD,EAASC,GAAT,EAAc;AAC5CW,IAAAA,MAAM,EAAE,CAAE,QAAON,YAAa,EAAtB,EAAyB,GAAGO,IAAI,CAACC,KAAL,CAAWT,OAAX,CAA5B;AADoC,GAAd,CAAhC,CAPsC,CAWtC;;AACA,SAAO;AACLU,IAAAA,EAAE,EAAEN,IAAI,CAACM,EADJ;AAELC,IAAAA,IAAI,EAAEP,IAAI,CAACO,IAFN;AAGLC,IAAAA,KAAK,EAAER,IAAI,CAACS,SAHP;AAILC,IAAAA,WAAW,EAAE,CACX;AACEC,MAAAA,IAAI,EAAE,MADR;AAEEC,MAAAA,IAAI,EAAE;AAFR,KADW,EAKX;AACED,MAAAA,IAAI,EAAEX,IAAI,CAACa,gBADb;AAEED,MAAAA,IAAI,EAAG,MAAKZ,IAAI,CAACa,gBAAiB;AAFpC,KALW,CAJR;AAcL,OAAGX;AAdE,GAAP;AAgBD","sourcesContent":["import fulfillAPIRequest from 'react-storefront/props/fulfillAPIRequest'\nimport getClient from './utils/client'\nimport createAppData from './utils/createAppData'\nimport productListing from './utils/productListing'\n\nexport default async function subcategory(params, req) {\n  return await fulfillAPIRequest(req, {\n    appData: createAppData,\n    pageData: () => getPageData(params, req),\n  })\n}\n\nasync function getPageData(params, req) {\n  const { filters = '[]' } = params\n  const { categorySlug } = req.query\n\n  const client = await getClient(req)\n  const data = await client.getCategory(categorySlug)\n\n  const plp = await productListing(params, req, {\n    refine: [`cgid=${categorySlug}`, ...JSON.parse(filters)],\n  })\n\n  // collect all page data\n  return {\n    id: data.id,\n    name: data.name,\n    title: data.pageTitle,\n    breadcrumbs: [\n      {\n        text: 'Home',\n        href: '/',\n      },\n      {\n        text: data.parentCategoryId,\n        href: `/s/${data.parentCategoryId}`,\n      },\n    ],\n    ...plp,\n  }\n}\n"],"file":"subcategory.js"}